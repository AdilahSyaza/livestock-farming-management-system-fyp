<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Sheep</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- resources from website multiple form -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous"> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" crossorigin="anonymous"></script> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

    <style>
        #menu a:hover,
        #menu a.active{
            color: white;
            /* background:white; */
            background: #1D271A;
            /* border-right: 2px solid rgb(96, 122, 138); */
            width: auto;
        }
        .bi {
        vertical-align: -.125em;
        fill: currentColor;
      }

      #sidebar{
        background-color: #223226;
      }

      #bg-navbar,
      #bg-navbar a{
        background-color: #960017;
        color: white;
      }

      #sidebar-title,
      #sidebar-title a
      {
        background: #7D000F;
        /* margin: -10px; */
        width: 100%;
        text-align: center;
        word-wrap:break-word;
        display: block;
        white-space: normal;
        color: white;
      }
      hr {
        width: 80%; 
        margin-right: auto;
        margin-left: auto;
        color: whitesmoke; 
        height: 1px; 
        background-color:whitesmoke; 
      }

      /* your CSS goes here*/
 /* body {
    background: #eee
} */

/* #regForm {
    background-color: #ffffff;
    margin: 0px auto;
    font-family: Raleway;
    padding: 40px;
    border-radius: 10px
} */

h1 {
    text-align: center
}

/* input {
    padding: 10px;
    width: 100%;
    font-size: 17px;
    font-family: Raleway;
    border: 1px solid #aaaaaa
} */

input.invalid {
    background-color: #ffdddd
}

.tab {
    display: none
}

/* button {
    background-color: #4CAF50;
    color: #ffffff;
    border: none;
    padding: 10px 20px;
    font-size: 17px;
    font-family: Raleway;
    cursor: pointer
} */

button:hover {
    opacity: 0.8
}

#prevBtn {
    background-color: #bbbbbb
}

.step {
    height: 15px;
    width: 15px;
    margin: 0 2px;
    background-color: #bbbbbb;
    border: none;
    border-radius: 50%;
    display: inline-block;
    opacity: 0.5
}

.step.active {
    opacity: 1
}

.step.finish {
    background-color: #4CAF50
}

.all-steps {
    text-align: center;
    margin-top: 30px;
    margin-bottom: 30px
}

.thanks-message {
    display: none
}

/* .container {
    display: block;
    position: relative;
    padding-left: 35px;
    margin-bottom: 12px;
    cursor: pointer;
    font-size: 22px;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
} */


/* Hide the browser's default radio button */

.container input[type="radio"] {
    position: absolute;
    opacity: 0;
    cursor: pointer;
}


/* Create a custom radio button */

.checkmark {
    position: absolute;
    top: 0;
    left: 0;
    height: 25px;
    width: 25px;
    background-color: #eee;
    border-radius: 50%;
}


/* On mouse-over, add a grey background color */

.container:hover input~.checkmark {
    background-color: #ccc;
}


/* When the radio button is checked, add a blue background */

.container input:checked~.checkmark {
    background-color: #2196F3;
}


/* Create the indicator (the dot/circle - hidden when not checked) */

.checkmark:after {
    content: "";
    position: absolute;
    display: none;
}


/* Show the indicator (dot/circle) when checked */

.container input:checked~.checkmark:after {
    display: block;
}


/* Style the indicator (dot/circle) */

.container .checkmark:after {
    top: 9px;
    left: 9px;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: white;
}
</style>
    
</head>
<body>
    {% include "sidebarAnimal.html" %}
          <!-- content area! -->
          <div class="col px-0 bg-light">

            <!-- <nav class="navbar sticky-top navbar-light" id="bg-navbar">
              <div class="container-fluid">
                <a class="navbar-brand" href="#">{% now "Y-m-d" %} Hello {{ user.email }}</a>
              </div>
            </nav> -->
            {% include "navbar.html" %}

            <h3 class="p-3 bg-white">
                ANIMAL <br>
                <small class="text-muted">Management of Animal</small>
            </h3>

            <h4 class="p-3">
                Update Animal
            </h4>

            {% if messages %}
                <div class="container">
                <hr>
                {% for msg in messages %}
                <b>{{msg}}</b>
                {% endfor %}
                </div>
                <hr>
            {% endif %}

            <div class="container p-3 bg-white">

                <div class="container">
                    <div class="row d-flex justify-content-center align-items-center">
                        <div class="col-md-6">
                            <form id="regForm" method="POST" action="{% url 'animal:updateSheep' sheep.id %}" enctype="multipart/form-data">
                                {% csrf_token %}
                                <h1 id="register">Update Sheep</h1>
                                <div class="all-steps" id="all-steps"> 
                                  <span class="step"></span> 
                                  <span class="step"></span> 
                                  <span class="step"></span> 
                                  <!-- <span class="step"></span>  -->
                                </div>
                                <div id="submitStatus" style="display: none; text-align: center;">
                                    <p class="text-muted">Submitting the information. Please wait.</p>
                                </div>
                                <div class="tab">
                                    <h2 id="register">General</h2>
                                    <hr>
                                    <div class="mb-3 row">
                                        <label for="priority" class="col-sm-2 col-form-label">Tag ID*</label>
                                        <div class="col">
                                            <input type="text" class="form-control" id="tagID" name="tagID" value="{{sheep.sheepTagID}}" required>
                                        </div>
                                        <label for="completionStatus" class="col-sm-2 col-form-label">Tag Position*</label>
                                        <div class="col">
                                            <select name="tagPosition" id="tagPosition" class="form-select" aria-label="Default select example">
                                                <option selected value="LEFT-EAR">Left-Ear</option>
                                                <option value="RIGHT-EAR">Right-Ear</option>
                                                <option value="BOTH-EAR">Both-Ear</option>
                                              </select>
                                        </div>
                                    </div>
                                      <div class="mb-3 row">
                                        <label for="type" class="col-sm-2 col-form-label">Sheep Type*</label>
                                        <div class="col">
                                            <select name="type" id="type" class="form-select" aria-label="Default select example">
                                                <option selected value="EWE">Ewe</option>
                                                <option value="RAM">Ram</option>
                                                <option value="LAMB">Lamb</option>
                                              </select>
                                        </div>
                                        <label for="status" class="col-sm-2 col-form-label">Status*</label>
                                        <div class="col">
                                            <select name="status" id="status" class="form-select" aria-label="Default select example">
                                                <option selected value="ACTIVE">Active</option>
                                                <option value="SOLD">Sold</option>
                                                <option value="DIED">Died</option>
                                              </select>
                                        </div>
                                      </div>
                                      <div class="mb-3 row">
                                        <label for="breed" class="col-sm-2 col-form-label">Breed</label>
                                        <div class="col-sm-10">
                                          <input type="text" class="form-control" id="breed" name="breed" value="{{sheep.sheepBreed}}">
                                          <!-- <input type="text" class="form-control" id="taskName" name="taskName" oninput="this.className = ''" required> -->
                                        </div>
                                      </div>
                                      <div class="mb-3 row">
                                        <label for="hornStatus" class="col-sm-2 col-form-label">Horn Status*</label>
                                        <div class="col">
                                            <select name="hornStatus" id="hornStatus" class="form-select" aria-label="Default select example">
                                                <option selected value="HORNED">Horned</option>
                                                <option value="UNHORNED">Unhorned</option>
                                                <!-- <option value="HIGH">Calf</option> -->
                                              </select>
                                        </div>
                                        <label for="weaningStatus" class="col-sm-2 col-form-label">Weaning Status*</label>
                                        <div class="col">
                                            <select name="weaningStatus" id="weaningStatus" class="form-select" aria-label="Default select example">
                                                <option selected value="YES">Yes</option>
                                                <option value="NO">No</option>
                                              </select>
                                        </div>
                                      </div>
                                      <div class="mb-3 row">
                                        <label for="sheepGroup" class="col-sm-2 col-form-label">Sheep Group*</label>
                                        <div class="col-sm-10">
                                          <select name="sheepGroup" id="sheepGroup" class="form-select" aria-label="Default select example" multiple>
                                            {% for sheepGroup in sheepGroups %}
                                              <option value="{{sheepGroup.id}}">{{sheepGroup.sheepGroupName}}</option>
                                            {% endfor %}
                                            </select>
                                        </div>
                                      </div>
                                      <div class="mb-3">
                                        <label for="currentImage" class="form-label">For reference; Current Sheep Image</label>
                                        {% if sheep.sheepAttachment == null or sheep.sheepAttachment == '' %}
                                        <div class="col">
                                            <p class="text-muted">No image for this sheep</p>
                                        </div>
                                        {% else %}
                                        <div class="col">
                                            <img src="{{MEDIA_URL}}{{sheep.sheepAttachment}}" alt="sheep Pic" id="imgSrc" style="width:150px;height:100px;" class="img-thumbnail img_responsive_fixed_small">
                                        </div>
                                        {% endif %}

                                        <label for="fileupload" class="form-label">Media</label>
                                        <input class="form-control" type="file" id="fileupload" name="fileupload">
                                      </div>
                                      <div class="mb-3">
                                        <label for="remark" class="form-label">Remarks/Comment</label>
                                        <textarea class="form-control" id="remark" name='remark' rows="3">{{sheep.sheepComment}}</textarea>
                                      </div>
                
                                </div>
                                <div class="tab">
                                    <h2 id="register">Financial</h2>
                                    <hr>
                                    
                                    <div class="mb-3 row">
                                        <label for="purchasedOrNot" class="col-sm-2 col-form-label">Purchased*</label>
                                        <div class="col-sm-10">
                                            <select name="purchasedOrNot" id="purchasedOrNot" class="form-select" aria-label="Default select example">
                                                <option selected value="YES">Yes</option>
                                                <option value="NO">No</option>
                                              </select>
                                        </div>
                                      </div>
                                      <div class="mb-3 row">
                                        <label for="offerPrice" class="col-sm-2 col-form-label">Offer Price*</label>
                                        <div class="col-sm-10">
                                          <input type="text" class="form-control" id="offerPrice" name="offerPrice" value="{{sheep.sheepOfferPrice}}" required>
                                        </div>
                                      </div>
                                      <div class="mb-3">
                                        <label for="marketingNote" class="form-label">Marketing Note</label>
                                        <textarea class="form-control" id="marketingNote" name='marketingNote' rows="3">{{sheep.sheepCommercialNote}}</textarea>
                                      </div>
                
                                </div>
                                <div class="tab">
                                    <h2 id="register">Lambhood</h2>
                                    <hr>
                                    
                                    <div class="mb-3 row">
                                        <label for="birthdate" class="col-sm-2 col-form-label">Birthdate</label>
                                        <div class="col">
                                          <input type="date" class="form-control" id="birthdate" name="birthdate" value="{{sheep.sheepBirthDate|date:'Y-m-d'}}">
                                        </div>
                                    </div>
                                    <div class="mb-3 row">
                                        <label for="birthWeight" class="col-sm-2 col-form-label">Birth weight</label>
                                        <div class="col-sm-10">
                                          <input type="number" class="form-control" id="birthWeight" name="birthWeight" value="{{sheep.sheepBirthWeight}}">
                                        </div>
                                    </div>
                                    <div class="mb-3 row">
                                        <label for="sire" class="col-sm-2 col-form-label">Sire</label>
                                        <div class="col">
                                              <select name="sire" id="sire" class="form-select" aria-label="Default select example">
                                                <option disabled selected value>Selection of sire</option>
                                                {% for sire in possibleSire %}
                                                  <option value="{{sire.id}}">{{sire.sheepTagID}}</option>
                                                {% endfor %}
                                                </select>
                                        </div>
                                        <label for="dam" class="col-sm-2 col-form-label">Dam</label>
                                        <div class="col">
                                              <select name="dam" id="dam" class="form-select" aria-label="Default select example">
                                                <option disabled selected value>Selection of dam</option>
                                                {% for dam in possibleDam %}
                                                  <option value="{{dam.id}}">{{dam.sheepTagID}}</option>
                                                {% endfor %}
                                                </select>
                                        </div>
                                      </div>

                                </div>
                
                                <!-- <div class="thanks-message text-center" id="text-message"> <img src="https://i.imgur.com/O18mJ1K.png" width="100" class="mb-4">
                                    <h3>Thanks for your Donation!</h3> <span>Your donation has been entered! We will contact you shortly!</span>
                                </div> -->
                                <div style="overflow:auto;" id="nextprevious">
                                    <div style="float:right;"> 
                                      <button type="button" class="btn btn-success" id="prevBtn" onclick="nextPrev(-1)">Previous</button> 
                                      <button type="button" class="btn btn-success" id="nextBtn" onclick="nextPrev(1)">Next</button> 
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

            </div>
              
          </div>

          


        </div>
      </div>

      <script>
        //your javascript goes here
var currentTab = 0;
document.addEventListener("DOMContentLoaded", function(event) {


    showTab(currentTab);

});

function showTab(n) {
  // This function will display the specified tab of the form ...
    var x = document.getElementsByClassName("tab");
    x[n].style.display = "block";
    // ... and fix the Previous/Next buttons:
    if (n == 0) {
        document.getElementById("prevBtn").style.display = "none";
    } else {
        document.getElementById("prevBtn").style.display = "inline";
    }
    if (n == (x.length - 1)) {
        document.getElementById("nextBtn").innerHTML = "Update";
        // document.getElementById("nextBtn").setAttribute("type","submit");
        // document.getElementById("nextBtn").type="submit";
    } else {
        document.getElementById("nextBtn").innerHTML = "Next";
    }
     // ... and run a function that displays the correct step indicator:
    fixStepIndicator(n)
}

function nextPrev(n) {
  // This function will figure out which tab to display
    var x = document.getElementsByClassName("tab");
    // Exit the function if any field in the current tab is invalid:
    if (n == 1 && !validateForm()) return false;
    // Hide the current tab:
    x[currentTab].style.display = "none";
    // Increase or decrease the current tab by 1:
    currentTab = currentTab + n;
    // if you have reached the end of the form... :
    if (currentTab >= x.length) {
      //...the form gets submitted:
        document.getElementById("regForm").submit();
        document.getElementById("submitStatus").style.display = "block";
        return false;
        //alert("sdf");
        document.getElementById("nextprevious").style.display = "none";
        document.getElementById("all-steps").style.display = "none";
        document.getElementById("register").style.display = "none";
        // document.getElementById("text-message").style.display = "block";

    }
    // Otherwise, display the correct tab:
    showTab(currentTab);
}

function validateForm() {
  // This function deals with validation of the form fields
    var x, y, i, valid = true;
    x = document.getElementsByClassName("tab");
    y = x[currentTab].getElementsByTagName("input");
    // A loop that checks every input field in the current tab:
    for (i = 0; i < y.length; i++) {
      // If a field is empty...
      if(y[i].hasAttribute('required')){
        if (y[i].value == "") {
          // add an "invalid" class to the field:
            y[i].className += " invalid";
            // and set the current valid status to false:
            valid = false;
        }
        
      }
        // if (y[i].value == "") {
        //     y[i].className += " invalid";
        //     valid = false;
        // }
    }
     // If the valid status is true, mark the step as finished and valid:
    if (valid) { 
      document.getElementsByClassName("step")[currentTab].className += " finish"; 
    }
    return valid; // return the valid status
}

function fixStepIndicator(n) {
  // This function removes the "active" class of all steps...
    var i, x = document.getElementsByClassName("step");
    for (i = 0; i < x.length; i++) 
    { 
      x[i].className = x[i].className.replace("active", ""); 
    }
    //... and adds the "active" class to the current step:
    x[n].className += " active";
}
      </script>


<script>
  $('select option[value='+"{{sheep.sheepType}}"+']').attr('selected','selected');
  $('select option[value='+"{{sheep.sheepHornStatus}}"+']').attr('selected','selected');
  $('select option[value='+"{{sheep.sheepWeaningStatus}}"+']').attr('selected','selected');
  // $('select option[value='+"{{currentGrouping.cg_sheepGroup}}"+']').attr('selected','selected');
  {% for group in currentGrouping %}
    $('select option[value='+"{{group.sg_sheepGroup.id}}"+']').attr('selected','selected');
  {% endfor %}
  $('select option[value='+"{{sheep.sheepSire.id}}"+']').attr('selected','selected');
  $('select option[value='+"{{sheep.sheepDam.id}}"+']').attr('selected','selected');
</script>
    
</body>
</html>